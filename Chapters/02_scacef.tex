\chapter{Semi-Automatic Coronary Artery Centerline Extraction Framework}
%

\section{Introduction}
%
Efficiently obtaining a reliable coronary artery centerline from computed tomography angiography data is relevant in clinical practice. From the computer aided dignosis point of view, many vessel visualization techniques have been proposed to review CTA data[CADEMARTIRI et al.].  These visualizations can be used in quantitative analysis and diagnosis, surgical planning procedure (stent placement), among other things. Visualizations such multi-planar reformatting (MPR), and curved planar reformatting [Kanitsar et al.](CPR) use the central lumen line as a source, these techniques have succesfully been used as a starting point for lumen segmentation, stenosis grading, quantification and more. Therefore, having these centerlines is a prerequisite for the automatic lesion detection task.
In recent years, a variety of techniques have been proposed and evaluated succesfully [CITAR CAT08]. All of them, extract the coronary vessel centerlines from CTA images, and they are grouped according to its level of user interaction: automatic extraction, minimum user-interaction and interactive extraction methods.
This method finds a coronary vessel centerline interactively. Two seed points are manually placed by the radiologist and the path is automatically extracted using a minimum cost path approach (Dijkstra’s algorithm). The cost to travel through a voxel is based on a generalized logistic function applied to the non-linear flux vesselness response [CITAR A LESAGE] of the CTA image. Selective vessel radiuses can be provided to get rid off erroneously connected structures such coronary veins. Results shown robust and accurate centerline extraction in multi-vendor datasets.

This chapter is organized as follows... 

\section{Related Work}

more than twenty methods 
[Friman et al] (no user-interaction)
 [CITAR todos los de CAT08 categoria 2](one seed per vessel is provided)
[CITAR todos los de CAT08 categoria 3]  (more than one point per vessel as input)



\section{Flux and MFlux}

Flux is a gradient-based vesselness measure that exploits the orientation of gradient vectors by computing the gradient flux through the surface of an object. The flux F(S) through a surface S is defined as:

\section{Dijkstra}

\section{Cost Function}

In order to apply a minimal cost approach, a cost function is applied in every Flux vesselness voxel. The main idea is to give the minimum cost to high vessel responses and vice versa. Therefore, the key task is to find a cost function that fits the flux image dynamic. Some traits of the flux image are: the maximum voxel value varies between CTA scans, low mean and high variance values are expected in flux images, amongst others. However, finding a capable function is always part of the succes of this approach.

The Richard's curve [RICHARDS CURVE CITATION] or generalized logistic function is a widely-used and flexible sigmoid function for growth modeling, extending the well-known logistic curve. For this case, we start from the six-parameter version (See eq. \ref{eq:eq_2_1}) that fits a wide range of S-shaped growth curves. 
\begin{equation}
\label{eq:eq_2_1}
f\left( x;\delta,\beta,\gamma,\alpha,\mu,\nu\right) = \delta + \cfrac{\beta-\delta}{(1+\gamma e^{-\alpha(x-\mu)})^{1/\nu}}
\end{equation}
Where $\delta$ is the lower asymptote, $\beta$ is the upper asymptote, $\gamma$ is a variable which fixes the point of inflection, $\alpha$ is the growth rate; $\mu$ is the time of maximum growth and $\nu$ affects near which asymptote maximum growth occurs.
From equation \ref{eq:eq_2_1}, Assuming that $\gamma$ and $\nu$ are constants equal to 1, we got:
\begin{equation}
\label{eq:eq_2_2}
f\left( x;\delta,\beta,\alpha,\mu\right) = \delta + \cfrac{\beta-\delta}{1+e^{-\alpha(x-\mu)}}
\end{equation}
Once we have the simplified equation \ref{eq:eq_2_2}, we make the following assumptions in order to fit the particular flux image characteristics.
\begin{equation}
\label{eq:eq_2_3}
\delta = Cmin + Cmax
\end{equation}
Where $Cmin$ is the minimum cost, and $Cmax$ is the maximum cost to penalize the Dijkstra's algorithm. 
\begin{equation}
\label{eq:eq_2_4}
\beta = Cmax
\end{equation}
Where $\beta$ is the upper asymptote when the flux voxel value is minimum.
\begin{equation}
\label{eq:eq_2_5}
\mu = C \times mean(I_{Flux}) 
\end{equation}
We set $\mu$ as a multiplication between the mean volume vesselness response and a scalar $C$. $C$ is related to the radiuses evaluated.

Finally, our cost function \ref{eq:eq_2_6} is in terms of Flux response and costs.
\begin{equation}
\label{eq:eq_2_6}
f( I_{Flux};Cmin, Cmax, \alpha,\mu) == 2\times mean(I_{Flux}) 
\end{equation}

\section{Dealing with Bifurcations: Bezier's Curve}

As the Dijkstra's extraction advances, some part of the coronary artery vessel may present multiple centerpoints due to a vessel division (bifurcation). In order to refine the centerline points into individual vessels. A B\'ezier's approximation [CITAR A BEZIER] is applied as a refinement step (post-processing) (Figure \ref{fig:sp_vs_bz}). 

\begin{figure}[ht]
	\centering
		\includegraphics[width=0.7\textwidth]{./Figures/spline.png}
		\includegraphics[width=0.7\textwidth]{./Figures/bezier.png}
	\caption[Spline interpolation VS B\'ezier approximation]{2D illustration of a Spline interpolation VS a B\'ezier approximation  (source: \href{http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-837-computer-graphics-fall-2003/index.htm}{MIT 6.837 Lecture notes}).}
	\label{fig:sp_vs_bz}
\end{figure}


\section{Parameter optimization}

Some parameter optimization can be done in the equation cost equation. The slope is always


CITAS A BUSCAR Y AGREGAR
F. Cademartiri, L. L. Grutta, A. Palumbo, P. Malagutti, F. Pugliese, W. B. Meijboom, T. Baks, N. R. Mollet, N. Bruining, R. Hamers, and P. J. de Feyter. Non-invasive vi- sualization of coronary atherosclerosis: state-of-art. Journal of Cardiovascular Medicine, 8(3):129–137, 2007.

A.Kanitsar,D.Fleischmann,R.Wegenkittl,P.Felkel,andM.E.Gröller.CPR-Curved Planar Reformation. In Proceedings of IEEE Visualization, 2002.
